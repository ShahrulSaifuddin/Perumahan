---
phase: 7
plan: fix-tech-debt
wave: 1
gap_closure: true
---

# Fix: Technical Debt & Type Safety

## Problem

1.  `server/actions/transactions.ts` uses `@ts-expect-error` to bypass type checks for Supabase joined queries (e.g., `creator.email`). This is fragile.
2.  Email sender address is hardcoded in `lib/resend.ts`.
3.  Error handling in UI forms isn't consistent (some use toast, some use inline alerts).

## Root Cause

- Supabase Javascript client returns complex types for joins that don't match simple interfaces automatically.
- Hardcoded constants were used for speed during MVP.

## Tasks

<task type="auto">
  <name>Fix TypeScript Errors</name>
  <files>server/actions/transactions.ts</files>
  <action>Define proper interfaces for the joined query result (e.g., `TransactionWithCreator`) and cast the Supabase response correctly instead of using `@ts-expect-error`.</action>
  <verify>Run `npm run build` to ensure no type errors (and remove the suppressions).</verify>
  <done>No `@ts-expect-error` in `transactions.ts`.</done>
</task>

<task type="auto">
  <name>Externalize Email Config</name>
  <files>lib/resend.ts, .env.local</files>
  <action>Move `EMAIL_FROM` to `process.env.EMAIL_FROM` with a fallback.</action>
  <verify>Check checking `.env.local` usage.</verify>
  <done>Code uses env var.</done>
</task>
