---
phase: 3
plan: 3.1
wave: 1
---

# Plan 3.1: Complaint Submission & Dashboard

## Objective

Implement the core complaint submission flow and the dashboard to view complaint lists.

## Context

- `SPEC.md` (Complaints Rules: Create + Status Flow).
- `RESEARCH.md` (Schema: `complaints` table, RLS policies).

## Tasks

<task type="auto">
  <name>Implement Complaint Actions & API</name>
  <files>
    server/actions/complaints.ts
    lib/api/complaints.ts
  </files>
  <action>
    - `createComplaint(formData)`: Insert into `complaints`. Handle optional attachments (Phase 3.2 or basic text now).
    - `getComplaints(filters)`: Fetch complaints based on role (Resident sees own, DBKL sees all, Leader sees property).
  </action>
</task>

<task type="auto">
  <name>Implement Complaint UI</name>
  <files>
    features/complaints/complaint-form.tsx
    features/complaints/complaint-list.tsx
    features/complaints/status-badge.tsx
    app/complaints/page.tsx
    app/complaints/new/page.tsx
  </files>
  <action>
    - `ComplaintForm`: Title, Description, Category.
    - `ComplaintList`: Card view or Table view of complaints.
    - `StatusBadge`: Visual indicator for OPEN, IN_REVIEW, etc.
    - Page: `/complaints` (List), `/complaints/new` (Create).
  </action>
  <verify>
    - Resident logs in.
    - Submits a complaint.
    - Redirects to list.
    - Complaint appears in list with status OPEN.
  </verify>
</task>

## Success Criteria

- [ ] Users can submit a complaint.
- [ ] Users can see their complaints.
- [ ] DBKL/Leaders can see relevant complaints.
