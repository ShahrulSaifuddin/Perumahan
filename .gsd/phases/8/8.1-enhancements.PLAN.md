---
phase: 8
plan: enhancements
wave: 1
---

# Phase 8: Enhancements (SLA & i18n)

## Goal

Implement Service Level Agreement (SLA) tracking for complaints to ensure timely resolution, and introduce Multi-language support (Bahasa Malaysia) for broader accessibility.

## Proposed Changes

### 1. SLA Tracking (Complaints)

- **Database**: Add `sla_due_at` (timestamptz) column to `complaints` table (Supabase migration required manually or via SQL runner).
- **Backend**: Update `createComplaint` action to set `sla_due_at` based on category (default: 3 days).
- **UI**:
  - Display "Due Date" in Complaint List.
  - Show "Overdue" badge if `now > sla_due_at` and status is not Resolved.

### 2. Multi-language Support (i18n)

- **Strategy**: Use `next-intl` with client-side context (App Router compatible) to avoid deeply nested `[locale]` routes refactor for now unless necessary.
- **Configuration**:
  - `i18n.ts`: Setup request config.
  - `middleware.ts`: Handle locale detection.
- **Components**:
  - Translate `Sidebar`, `TopNav`, and `Dashboard` stats as MVP.

## Detailed Plan

### Wave 1: SLA Tracking

#### [NEW] `supabase/migrations/YYYYMMDD_add_sla.sql`

- Add `sla_due_at` column.

#### [MODIFY] `server/actions/complaints.ts`

- Calculate `sla_due_at` during insertion.
- Fix type safety issues (`@ts-expect-error`) in `complaints.ts` as part of this work.

#### [MODIFY] `features/complaints/complaint-list.tsx`

- Render SLA badge using `date-fns` relative helpers.

### Wave 2: Internationalization (i18n)

#### [NEW] `messages/en.json` & `messages/ms.json`

#### [NEW] `i18n.ts`

#### [MODIFY] `middleware.ts`

- Add locale handling.

## Verification Plan

### Automated

- Build success (`npm run build`).

### Manual

1.  **SLA**: Create a complaint. Check DB for `sla_due_at`. UI should show "Due in 3 days".
2.  **i18n**: Switch language via URL (e.g., `/ms/...` or query param if simpler) or toggle. Verify text changes.
